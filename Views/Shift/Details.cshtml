@model TomorrowsVoice_Toplevel.Models.Volunteering.Shift
@{

	Layout = "~/Views/Shared/_EventAdminLayout.cshtml";

}

<h1>@Model.Event.Name Shift</h1>
<strong>@Model.TimeSummary</strong>
<hr />
<label>Volunteer(s) Signed Up:</label>
<p style="display: inline"> @Model.UserShifts.Count()/@Model.VolunteersNeeded</p>
<ul>
	@foreach (var v in Model.UserShifts)
	{
		<li>
			@v.User.NameFormatted
			@if (v.User is Director)
			{
				<span> - Director</span>
			}
		</li>
	}
</ul>
@* <div>
	<dl class="row">
		<div class="col-auto">
			
			
			<ul>

			</ul>
			@foreach(var v in Model.UserShifts)
			{
				<p>
					@v.User.NameFormatted
					@if (v.User is Director)
					{
						<span> - Director</span>
					}
				</p>
			}
		</div>
		<div class="col-6" style="max-height:350px;">
			<div class="ml-3" style="max-height: 100%;overflow-y: scroll;overflow-x: clip;" id="chatbox"></div>
		</div>
	</dl>
</div> *@
@{
	if (Model.VolunteersNeeded > Model.UserShifts.Count())
	{
		<div style="display: grid; place-content: center;">
			<h2>Confirm Sign-Up</h2>
			<form asp-action="ShiftSignUp" asp-route-shiftID="@Model.ID" asp-route-volID="VALUE_OF_VOLID" method="post" class="form-container">
				<div class="form-area">
					<div asp-validation-summary="ModelOnly" class="text-danger"></div>
					<div class="row">
						<div class="col-md-4">
							<label class="control-label" for="VolunteerID" style="margin-top: 7px">Select a Volunteer:</label>
						</div>
						<div class="col-md-4">
							@Html.DropDownList("VolunteerID", null, "- Select a Volunteer", htmlAttributes: new { @class = "form-control", id = "VolunteerID" })
						</div>
					</div>
					<div style="margin-top: 10px">
						Are you sure you want to sign up for
						<strong>@Html.DisplayFor(Model => Model.Event.Name)</strong>
						from
						<strong>@Html.DisplayFor(model => model.StartAt)</strong>
						to
						<strong>@Html.DisplayFor(model => model.EndAt)</strong>
						?
					</div>
				</div>
				<div class="form-footer">
					@Html.AntiForgeryToken()
					<input type="hidden" name="shiftID" value="@Model.ID" />
					<input type="hidden" name="volID" value="" id="volInput" />
					<button type="submit" class="btn btn-primary" disabled id="btnSubmit">Sign Up</button>
				</div>
			</form>
		</div>
	}
	else
	{
		<a disabled>No more volunteers needed</a>
	}
}


<div>
	<a asp-action="Edit" asp-route-id="@Model?.ID">Edit</a> |
	<a href="javascript:history.back()">Back to List</a>
	<!--Link to sign up for this shift that only shows up if volunteers are needed-->
	
</div>

<script>
	// get elements
	var dropDown = document.getElementById("VolunteerID");
	var signUpLink = document.getElementById("SignUp");
	var submitButton = document.getElementById("btnSubmit");
	var dropValue;
	// set values when dropdown changed
	dropDown.addEventListener("change",
		() =>
		{
			dropValue = dropDown.value;
			console.log(dropValue);
			document.getElementById("volInput").value = dropValue;
			if (dropValue !== ""){
				submitButton.disabled = false;
			}
			else{
				submitButton.disabled = true;
			}
		});
</script>
